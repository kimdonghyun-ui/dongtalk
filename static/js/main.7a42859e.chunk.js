(this.webpackJsonpdongtalk=this.webpackJsonpdongtalk||[]).push([[0],{128:function(e,t,n){},140:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),c=n.n(o),s=n(58),i=n(20),l=n(98),u=(n(128),n(37)),m=n(16),d=n(10),j="menu/RX_AUTHENTICATED",f="menu/RX_ALL_USERS",g="menu/RX_ME",b="menu/RX_CONNECTED",h="menu/RX_MYROOMLIST",p="menu/RX_ALLROOMLIST",x="menu/RX_ALLMSGLIST",O="menu/RX_FOCUSMSG",v="menu/RX_REMOVE",y="menu/RX_FOCUSROOM",_="menu/RX_LOADING1",w="menu/RX_LOADING2",C="menu/RX_LOADING3",k="menu/RX_MSGLENGTH",S="menu/RX_MSGLENGTH2",N="menu/RX_ALL_MY_MSGLENGTH",R="menu/RX_TABINDEX",L=function(e){return{type:O,result:e}},I=function(e){return{type:y,result:e}},U=function(e){return{type:S,result:e}},E=function(e){return{type:R,result:e}},T={authenticated:!1,all_users:[],me:{},all_connected:"",myroomlist:[],allroomlist:[],allmsglist:[],focusmsg:[],focusroom:"",loading1:!1,loading2:!1,loading3:!1,msglength:null,msglength2:null,all_my_msglength:0,tabindex:0};var A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(d.a)(Object(d.a)({},e),{},{authenticated:t.result});case f:return Object(d.a)(Object(d.a)({},e),{},{all_users:t.result});case g:return Object(d.a)(Object(d.a)({},e),{},{me:t.result});case b:return Object(d.a)(Object(d.a)({},e),{},{all_connected:t.result});case h:return Object(d.a)(Object(d.a)({},e),{},{myroomlist:t.result});case p:return Object(d.a)(Object(d.a)({},e),{},{allroomlist:t.result});case x:return Object(d.a)(Object(d.a)({},e),{},{allmsglist:t.result});case O:return Object(d.a)(Object(d.a)({},e),{},{focusmsg:t.result});case v:return Object(d.a)(Object(d.a)({},e),{},{focusmsg:e.focusmsg.filter((function(e){return e.key!==t.key}))});case y:return Object(d.a)(Object(d.a)({},e),{},{focusroom:t.result});case _:return Object(d.a)(Object(d.a)({},e),{},{loading1:t.result});case w:return Object(d.a)(Object(d.a)({},e),{},{loading2:t.result});case C:return Object(d.a)(Object(d.a)({},e),{},{loading3:t.result});case k:return Object(d.a)(Object(d.a)({},e),{},{msglength:t.result});case S:return Object(d.a)(Object(d.a)({},e),{},{msglength2:t.result});case N:return Object(d.a)(Object(d.a)({},e),{},{all_my_msglength:t.result});case R:return Object(d.a)(Object(d.a)({},e),{},{tabindex:t.result});default:return e}},M=n(44),D=n(62);n(141),n(129),n(131);D.a.initializeApp({apiKey:"AIzaSyAtKM1gMUkzx8Al9G5Y6jozCsTTezqmo4M",authDomain:"dongtalk-82851.firebaseapp.com",databaseURL:"https://dongtalk-82851-default-rtdb.firebaseio.com",projectId:"dongtalk-82851",storageBucket:"dongtalk-82851.appspot.com",messagingSenderId:"63820293757",appId:"1:63820293757:web:1d2960afd6d6ddf589b314",measurementId:"G-E7K9VBW4D0"});var B=D.a,W=D.a.auth(),X=(D.a.firestore(),D.a.database());function F(e){if(!0===e){var t=W.currentUser.uid,n=X.ref("UsersConnection/".concat(t));X.ref(".info/connected").on("value",(function(e){!0===e.val()?(console.log("connected"),n.set({connection:!0,uid:t})):(console.log("not connected"),n.set({connection:!1,uid:t}))})),n.onDisconnect().set({connection:!1,uid:t})}}function z(e){console.log("member",e),W.setPersistence(B.auth.Auth.Persistence.SESSION).then((function(){return console.log("\ub85c\uadf8\uc778 \uc720\uc9c0 \uc911"),W.signInWithEmailAndPassword(e.email,e.password)})).catch((function(e){console.log("\ub85c\uadf8\uc778 \uc720\uc9c0 \uc2e4\ud328");var t=e.code,n=e.message;console.log("errorCode",t),console.log("errorMessage",n)}))}function G(e,t){if(""!==t){var n=X.ref("msg/".concat(t)).push().key,a={message:e.message,timestamp:e.timestamp,uid:e.uid,avatar:e.avatar,key:n,name:e.name},r={};return r["msg/".concat(t,"/").concat(n)]=a,X.ref().update(r)}alert("\ubc29\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694")}function J(e){return W.signInWithEmailAndPassword(e.email,e.password).then((function(){console.log("signIn()\ub85c\uadf8\uc778\uc131\uacf5")})).catch((function(e){console.log("signIn()\uc2e4\ud328")}))}function P(e){return W.createUserWithEmailAndPassword(e.email,e.password).then((function(){console.log("signUp()\uac00\uc785\uc131\uacf5",e.email,e.password);var t=X.ref("all_users").push().key,n={email:e.email,name:e.name,password:e.password,uid:W.currentUser.uid,avatar:e.avatar,key:t},a={};return a["/all_users/"+t]=n,X.ref().update(a)})).catch((function(e){alert("The email address is already in use by another account."===e.message&&"\uc774\ubbf8 \uc788\ub294 \uc544\uc774\ub514\uc785\ub2c8\ub2e4.")}))}function Y(){return X.ref("UsersConnection/".concat(W.currentUser.uid)).set({connection:!1,uid:W.currentUser.uid}),W.signOut().then((function(){console.log("\ub85c\uadf8\uc544\uc6c3 \uc131\uacf5")})).catch((function(e){console.log("\ub85c\uadf8\uc544\uc6c3 \uc2e4\ud328")}))}function H(e,t){if(""!==e){var n=e.filter((function(e){return e.uid===t}));return n.length>0&&n[0].connection}}function q(e,t,n,a){e&&(console.log("CM_my_msgLength_change"),X.ref("msgLength/".concat(e)).once("value").then((function(r){var o=r.val();console.log(o),X.ref("My_msgLength2/".concat(W.currentUser.uid,"/").concat(e)).set(o,(function(r){if(r)console.log("The write failed...");else{console.log("Data saved successfully!");var c=JSON.parse(JSON.stringify(n));c[W.currentUser.uid][e]=o,console.log(c),t(c),a&&a(2)}}))})))}var V=n(182),$=n(59),K=n(4);var Z=function(e){var t=e.component,n=e.authenticated,a=Object($.a)(e,["component","authenticated"]);return Object(K.jsx)(m.b,Object(d.a)(Object(d.a)({},a),{},{render:function(e){return!1===n?Object(K.jsx)(t,Object(d.a)({},e)):Object(K.jsx)(m.a,{to:"/chat"})}}))};var Q=function(e){var t=e.component,n=e.authenticated,a=Object($.a)(e,["component","authenticated"]);return Object(K.jsx)(m.b,Object(d.a)(Object(d.a)({},a),{},{render:function(e){return!0===n?Object(K.jsx)(t,Object(d.a)({},e)):Object(K.jsx)(m.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},ee=n(46),te=n.n(ee),ne=n(57),ae=n(34),re=n(183),oe=n(63),ce=n(184),se=n(185),ie=n(206),le=n(186),ue=n(200),me=n(187),de=n(207),je=n(189),fe=n(203),ge=n(201),be=n(79),he=n.n(be);function pe(){return Object(K.jsxs)(oe.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(K.jsx)(V.a,{component:u.b,to:"https://material-ui.com/",children:"Your Website"})," ",(new Date).getFullYear(),"."]})}var xe=Object(re.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));var Oe=function(){var e=xe(),t=Object(a.useState)({email:"",name:"",password:"",avatar:""}),n=Object(ae.a)(t,2),r=n[0],o=n[1],c=function(e){var t=e.target,n=t.name,a=t.value;o(Object(d.a)(Object(d.a)({},r),{},Object(M.a)({},n,a)))};console.log(r);var s=function(){var e=Object(ne.a)(te.a.mark((function e(t){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),""!==r.email&&""!==r.password&&""!==r.name&&P(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function i(e){var t=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return!(e.length>0)||t.test(e)}function l(e){var t=new RegExp(/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/g);return!(e.length>0)||t.test(e)}function m(e){var t=new RegExp(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/);return!(e.length>0)||t.test(e)}return Object(K.jsxs)(ce.a,{component:"main",maxWidth:"xs",children:[Object(K.jsx)(se.a,{}),Object(K.jsxs)("div",{className:e.paper,children:[Object(K.jsx)(ie.a,{className:e.avatar,children:Object(K.jsx)(he.a,{})}),Object(K.jsx)(oe.a,{component:"h1",variant:"h5",children:"\ud68c\uc6d0 \uac00\uc785"}),Object(K.jsxs)("form",{className:e.form,noValidate:!0,onSubmit:s,children:[Object(K.jsxs)(le.a,{container:!0,spacing:2,children:[Object(K.jsx)(le.a,{item:!0,xs:12,children:Object(K.jsx)(ue.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",value:r.email,onChange:c,error:!i(r.email),helperText:!i(r.email)&&"emali \ud615\uc2dd\uc5d0 \ub9de\uac8c \uc785\ub825\ud574\uc8fc\uc138\uc694."})}),Object(K.jsx)(le.a,{item:!0,xs:12,children:Object(K.jsx)(ue.a,{variant:"outlined",required:!0,fullWidth:!0,id:"name",label:"name",name:"name",autoComplete:"name",value:r.name,onChange:c,error:!l(r.name),helperText:!l(r.name)&&"\ud55c\uae00\ub9cc \uc785\ub825\ud574\uc8fc\uc138\uc694."})}),Object(K.jsx)(le.a,{item:!0,xs:12,children:Object(K.jsx)(ue.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:r.password,onChange:c,error:!m(r.password),helperText:!m(r.password)&&"password\ub294 \ucd5c\uc18c 8 \uc790, \ucd5c\uc18c \ud558\ub098\uc758 \ubb38\uc790 \ubc0f \ud558\ub098\uc758 \uc22b\uc790"})}),Object(K.jsx)(le.a,{item:!0,xs:12,children:Object(K.jsxs)("div",{children:[Object(K.jsx)(me.a,{component:"legend",children:"Avatar"}),Object(K.jsxs)(de.a,{"aria-label":"gender",name:"avatar",value:r.avatar,onChange:c,style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:[Object(K.jsx)(je.a,{value:"https://material-ui.com/static/images/avatar/1.jpg",control:Object(K.jsx)(fe.a,{}),label:Object(K.jsx)(ie.a,{alt:"Remy Sharp",src:"https://material-ui.com/static/images/avatar/1.jpg"})}),Object(K.jsx)(je.a,{value:"https://material-ui.com/static/images/avatar/2.jpg",control:Object(K.jsx)(fe.a,{}),label:Object(K.jsx)(ie.a,{alt:"Remy Sharp",src:"https://material-ui.com/static/images/avatar/2.jpg"})}),Object(K.jsx)(je.a,{value:"https://material-ui.com/static/images/avatar/3.jpg",control:Object(K.jsx)(fe.a,{}),label:Object(K.jsx)(ie.a,{alt:"Remy Sharp",src:"https://material-ui.com/static/images/avatar/3.jpg"})})]})]})})]}),Object(K.jsx)(V.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,children:"\uac00\uc785\ud558\uae30"}),Object(K.jsx)(le.a,{container:!0,justifyContent:"flex-end",children:Object(K.jsxs)(le.a,{item:!0,children:["\uc774\ubbf8 \ud68c\uc6d0\uc774\uc2e0\uac00?"," ",Object(K.jsx)(V.a,{component:u.b,to:"/login",children:"\ub85c\uadf8\uc778"})]})})]})]}),Object(K.jsx)(ge.a,{mt:5,children:Object(K.jsx)(pe,{})})]})};function ve(){return Object(K.jsxs)(oe.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(K.jsx)(V.a,{component:u.b,to:"https://material-ui.com/",children:"Your Website"})," ",(new Date).getFullYear(),"."]})}var ye=Object(re.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));var _e=function(){var e=ye(),t=Object(a.useState)({email:"",password:""}),n=Object(ae.a)(t,2),r=n[0],o=n[1],c=function(e){var t=e.target,n=t.name,a=t.value;o(Object(d.a)(Object(d.a)({},r),{},Object(M.a)({},n,a)))},s=function(){var e=Object(ne.a)(te.a.mark((function e(t){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),""!==r.email&&""!==r.password&&J(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function i(e){var t=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return!(e.length>0)||t.test(e)}return Object(K.jsxs)(ce.a,{component:"main",maxWidth:"xs",children:[Object(K.jsx)(se.a,{}),Object(K.jsxs)("div",{className:e.paper,children:[Object(K.jsx)(ie.a,{className:e.avatar,children:Object(K.jsx)(he.a,{})}),Object(K.jsx)(oe.a,{component:"h1",variant:"h5",children:"\ub85c\uadf8\uc778"}),Object(K.jsxs)("form",{className:e.form,onSubmit:s,noValidate:!0,children:[Object(K.jsx)(ue.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"\uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694.",name:"email",autoComplete:"email",autoFocus:!0,value:r.email,onChange:c,error:!i(r.email),helperText:!i(r.email)&&"emali \uc81c\ub300\ub85c \uc785\ub825\ud574\uc8fc\uc138\uc694."}),Object(K.jsx)(ue.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:r.password,onChange:c,error:!1,helperText:!1}),Object(K.jsx)(V.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,children:"Sign In"}),Object(K.jsxs)(le.a,{container:!0,children:[Object(K.jsx)(le.a,{item:!0,xs:!0}),Object(K.jsx)(le.a,{item:!0,children:Object(K.jsx)(V.a,{component:u.b,to:"/signup",children:"\ud68c\uc6d0\uac00\uc785"})})]})]})]}),Object(K.jsx)(ge.a,{mt:8,children:Object(K.jsx)(ve,{})})]})},we=n(194),Ce=n(7),ke=n(190),Se=n(191),Ne=n(192),Re=n(193),Le=Object(Ce.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(ke.a),Ie=Object(i.b)((function(e){return{all_users:e.chats.all_users,msglength:e.chats.msglength,msglength2:e.chats.msglength2}}),(function(e){return{rx_focusroom:function(t){e(I(t))},rx_focusmsg:function(t){e(L(t))}}}))((function(e){var t=e.text,n=e.sub,a=e.uid,r=e.avatar,o=e.msg_key,c=e.me,s=e.invisible,i=e.event,l=e.rx_focusroom,u=e.rx_focusmsg,m=e.all_users,d=e.msglength,j=e.msglength2;return Object(K.jsxs)("li",{style:{display:o?"flex":"block"},children:[Object(K.jsxs)(Se.a,{button:!0,onClick:function(){return i(o||a)},children:[Object(K.jsx)(Ne.a,{children:Object(K.jsx)(ke.a,{color:"secondary",badgeContent:o?function(e){if(d&&j&&Object.values(d).length===Object.values(j[W.currentUser.uid]).length&&void 0!==d[e]&&void 0!==j[W.currentUser.uid][e])return console.log("\uac2f\uc218\uad6c\ud558\uae30",d[e]&&d[e]),console.log("\uac2f\uc218\uad6c\ud558\uae302",j[W.currentUser.uid][e]&&j[W.currentUser.uid][e]),d&&j&&d[e]-j[W.currentUser.uid][e]}(o):0,children:Object(K.jsx)(Le,{invisible:s,overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:Object(K.jsx)(ie.a,{alt:"Remy Sharp",src:r})})})}),Object(K.jsx)(Re.a,{primary:t,secondary:n})]}),o&&Object(K.jsx)(V.a,{onClick:function(){return function(e,t,n,a,r){var o=prompt("\ubcf8\uc778\uc758 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694");t.password===o?(X.ref("room/".concat(e)).remove(),X.ref("msg/".concat(e)).remove(),X.ref("msgLength/".concat(e)).remove(),r.map((function(t){return X.ref("msgLength2/".concat(t.uid,"/").concat(e)).remove()})),n(""),a([]),alert("\uc0ad\uc81c\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")):alert("\ube44\ubc00\ubc88\ud638\uac00 \ud2c0\ub824\uc11c \uc0ad\uc81c \ubd88\uac00\ud569\ub2c8\ub2e4")}(o,c,l,u,m)},children:"\uc0ad\uc81c"})]})})),Ue=n(188),Ee=n(195),Te=Object(re.a)((function(e){return{root:{paddingTop:"26px"},list:{position:"absolute",top:"98px",bottom:"72px",left:"24px",right:"25px",overflowY:"scroll"},divider:{},title:{position:"fixed",top:"0",left:"0",width:"100%",height:"50px",padding:"0 24px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#3f51b5",color:"#fff",fontSize:"20px",fontWeight:"bold","& button":{position:"absolute",right:"10px",color:"#fff"}}}})),Ae=Object(i.b)((function(e){return{all_users:e.chats.all_users,all_connected:e.chats.all_connected,me:e.chats.me[0]}}),null)((function(e){var t=e.title,n=e.data,r=e.event,o=e.all_users,c=e.all_connected,s=e.me,i=e.loading,l=Te();function u(e){return void 0!==e&&o.length>0&&o.filter((function(t){return t.uid===e}))[0].name}return Object(a.useEffect)((function(){console.log("[\ud45c\uc2dc]FriendList.js")}),[]),Object(K.jsxs)(ge.a,{className:l.root,children:[Object(K.jsxs)("div",{className:l.title,children:[s&&s.name,Object(K.jsx)(V.a,{onClick:function(){Y()},children:"\ub85c\uadf8\uc544\uc6c3"})]}),Object(K.jsx)(we.a,{component:"div",children:t}),Object(K.jsxs)(Ue.a,{className:l.list,children:[i&&Object(K.jsx)(ge.a,{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(K.jsx)(Ee.a,{color:"secondary"})}),n.length>0?n.map((function(e,t){return Object(K.jsx)(Ie,{invisible:!H(c,e.uid),text:Array.isArray(e.uid)?e.uid.map((function(e,t){return t>0?"/".concat(u(e)):u(e)})):u(e.uid),sub:void 0===e.email?"1:1 \ub300\ud654\ubc29":e.email,uid:e.uid,avatar:e.avatar,msg_key:e.msg_key,me:s,event:r},t)})):Object(K.jsx)("li",{children:"\ub9ac\uc2a4\ud2b8\uac00\uc5c6\uc2b5\ub2c8\ub2e4."})]})]})})),Me=n(199),De=n(196),Be=n(205),We=n(82),Xe=n.n(We),Fe=n(84),ze=["username@gmail.com","user02@gmail.com"],Ge=Object(re.a)({avatar:{backgroundColor:Fe.a[100],color:Fe.a[600]}});function Je(e){var t=Ge(),n=e.onClose,a=e.selectedValue,r=e.open,o=e.data,c=e.focusroom;return console.log("\uae4c\ub974\ub974\ub974\uad81",o),Object(K.jsxs)(Be.a,{onClose:function(){n(a),console.log("\uae4c\ub974\ub974\ub974\uad81",o)},"aria-labelledby":"simple-dialog-title",open:r,children:[Object(K.jsx)(De.a,{id:"simple-dialog-title",children:"\uce5c\uad6c \ub9ac\uc2a4\ud2b8"}),Object(K.jsx)(Ue.a,{children:o.length>0?o.map((function(e,a){return Object(K.jsxs)(Se.a,{button:!0,onClick:function(){return t=e.uid,X.ref("room/".concat(c,"/uid")).once("value").then((function(e){var n=e.val();n.includes(t)?alert("\uc774\ubbf8 \ucd94\uac00\ub41c \uce5c\uad6c\uc785\ub2c8\ub2e4."):(n.push(t),X.ref("room/".concat(c)).update({uid:n}).then((function(){console.log("\uce5c\ucd94 \uc644\ub8cc",n)})).catch((function(e){console.log("\uce5c\ucd94 \uc2e4\ud328")})))})),void n(!1);var t},children:[Object(K.jsx)(Ne.a,{children:Object(K.jsx)(ie.a,{className:t.avatar,children:Object(K.jsx)(Xe.a,{})})}),Object(K.jsx)(Re.a,{primary:e.name})]},a)})):Object(K.jsx)("li",{children:"\ub9ac\uc2a4\ud2b8\uac00\uc5c6\uc2b5\ub2c8\ub2e4."})})]})}var Pe=Object(i.b)((function(e){return{all_users:e.chats.all_users,focusroom:e.chats.focusroom}}),null)((function(e){var t=e.all_users,n=e.focusroom,a=r.a.useState(!1),o=Object(ae.a)(a,2),c=o[0],s=o[1],i=r.a.useState(ze[1]),l=Object(ae.a)(i,2),u=l[0],m=l[1];return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(V.a,{variant:"outlined",color:"primary",onClick:function(){s(!0)},children:"\uce5c\uad6c\ucd94\uac00"}),Object(K.jsx)(Je,{data:t,focusroom:n,selectedValue:u,open:c,onClose:function(e){s(!1),m(e)}})]})})),Ye=Object(re.a)((function(e){return{root:{paddingTop:"26px"},lBox:{flexDirection:"row-reverse",display:"flex",textAlign:"right"},rBox:{flexDirection:"row-reverse",display:"flex",textAlign:"right"},appBar:{top:"auto",bottom:0,left:0,width:"100%","& input,& button":{width:"100%",height:"50px"}},listBox:{display:"flex",flexDirection:"column",position:"absolute",top:"98px",bottom:"165px",left:"24px",right:"25px",overflowY:"scroll"},listBoxItem:{display:"block"},listBoxItemavatar:{display:"flex"},title:{position:"fixed",top:"0",left:"0",width:"100%",height:"50px",padding:"0 24px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#3f51b5",color:"#fff",fontSize:"20px",fontWeight:"bold","& button":{position:"absolute",right:"10px",color:"#fff"}}}})),He=Object(i.b)((function(e){return{focusroom:e.chats.focusroom,me:e.chats.me[0]}}),(function(e){return{rx_remove:function(t){e({type:v,key:t})}}}))((function(e){var t=e.focusmsg,n=e.focusroom,o=e.rx_remove,c=e.loading,s=e.me,i=Ye();console.log("Message-focusroom",n);var l=Object(a.useRef)(null);return Object(a.useEffect)((function(){console.log("[\ud45c\uc2dc]Message.js"),function(){var e=l.current.scrollHeight-l.current.clientHeight;l.current.scrollTo(0,e)}()}),[t,n]),Object(K.jsxs)(ge.a,{className:i.root,children:[c&&Object(K.jsx)(ge.a,{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(K.jsx)(Ee.a,{color:"secondary"})}),Object(K.jsxs)("div",{className:i.title,children:[s&&s.name,Object(K.jsx)(V.a,{onClick:function(){Y()},children:"\ub85c\uadf8\uc544\uc6c3"})]}),Object(K.jsxs)(we.a,{component:"div",style:{display:"flex",justifyContent:"space-between",backgroundColor:"#fff"},children:["\ucc44\ud305\ubc29",""!==n&&Object(K.jsx)(Pe,{})]}),Object(K.jsx)(Ue.a,{className:i.listBox,ref:l,children:t.length>0?t.map((function(e,t){return Object(K.jsx)(Se.a,{className:i.listBoxItem,children:Object(K.jsxs)(ge.a,{style:{display:"flex",flexDirection:W.currentUser.uid===e.uid?"row-reverse":"row",textAlign:W.currentUser.uid===e.uid?"right":"left"},children:[Object(K.jsx)(Ne.a,{className:i.listBoxItemavatar,style:{justifyContent:W.currentUser.uid===e.uid?"flex-end":"flex-start"},children:Object(K.jsx)(ie.a,{alt:"Remy Sharp",src:e.avatar})}),Object(K.jsx)(Re.a,{primary:e.name,secondary:Object(K.jsxs)(r.a.Fragment,{children:[Object(K.jsx)(oe.a,{component:"span",variant:"body2",color:"textPrimary",style:{wordBreak:"break-all"},children:e.message}),Object(K.jsx)("br",{}),Me.a(e.timestamp,"yyyy-MM-dd HH:mm:ss")]})}),Object(K.jsx)(V.a,{style:{display:W.currentUser.uid!==e.uid?"none":"inline-flex"},onClick:function(){return function(e,t,n){X.ref("msg/".concat(e,"/").concat(t)).remove(),n(t),console.log("[\uba54\uc2dc\uc9c0 \uc0ad\uc81c]removeChats",e,t)}(n,e.key,o)},children:"\uc0ad\uc81c"})]})},t)})):Object(K.jsx)("li",{children:"\ub9ac\uc2a4\ud2b8\uac00\uc5c6\uc2b5\ub2c8\ub2e4."})})]})})),qe=n(103),Ve=n.n(qe),$e=Object(re.a)((function(e){return{InputBox:{display:"flex",backgroundColor:"#fff",position:"absolute",bottom:"70px",left:"0",width:"96%",margin:"2%",padding:"2%",boxShadow:"1px 1px 5px #a0a0a0",borderRadius:"5px",justifyContent:"space-between"},button:{margin:e.spacing(1)}}})),Ke=Object(i.b)((function(e){return{focusroom:e.chats.focusroom,me:e.chats.me[0],msglength2:e.chats.msglength2}}),(function(e){return{rx_msglength2:function(t){e(U(t))}}}))((function(e){var t=e.focusroom,n=e.me,r=e.rx_msglength2,o=e.msglength2,c=$e(),s=Object(a.useState)(""),i=Object(ae.a)(s,2),l=i[0],u=i[1],m=function(){var e=Object(ne.a)(te.a.mark((function e(a){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),u(""),G({message:l,timestamp:Date.now(),uid:W.currentUser.uid,avatar:n.avatar,name:null===W.currentUser.displayName?n.name:W.currentUser.displayName},t),q(t,r,o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(K.jsx)("form",{onSubmit:m,children:Object(K.jsxs)(ge.a,{className:c.InputBox,children:[Object(K.jsx)(ue.a,{id:"outlined-basic",label:"\uba54\uc2dc\uc9c0",value:l,onChange:function(e){u(e.target.value)},style:{width:"100%"}}),Object(K.jsx)(V.a,{variant:"contained",color:"primary",type:"submit",className:c.button,endIcon:Object(K.jsx)(Ve.a,{}),children:"Send"})]})})})),Ze=n(143),Qe=n(197),et=n(202),tt=n(198),nt=n(105),at=n.n(nt),rt=n(104),ot=n.n(rt),ct=Object(re.a)({root:{flexGrow:1,position:"absolute",width:"100%",height:"100%",margin:"0 auto",overflow:"hidden"},appBar:{top:"auto",bottom:0}});function st(e){var t=e.children,n=e.value,a=e.index,r=Object($.a)(e,["children","value","index"]);return Object(K.jsx)("div",Object(d.a)(Object(d.a)({role:"tabpanel",hidden:n!==a,id:"scrollable-prevent-tabpanel-".concat(a),"aria-labelledby":"scrollable-prevent-tab-".concat(a)},r),{},{children:n===a&&Object(K.jsx)(ge.a,{p:3,children:t})}))}function it(e){return{id:"scrollable-prevent-tab-".concat(e),"aria-controls":"scrollable-prevent-tabpanel-".concat(e)}}var lt=Object(i.b)((function(e){return{tabindex:e.chats.tabindex,all_my_msglength:e.chats.all_my_msglength}}),(function(e){return{rx_tabindex:function(t){e(E(t))}}}))((function(e){var t=e.content,n=e.rx_tabindex,o=e.tabindex,c=e.all_my_msglength,s=ct(),i=r.a.useState(0),l=Object(ae.a)(i,2),u=l[0],m=l[1];return Object(a.useEffect)((function(){console.log("[\ud45c\uc2dc]TabBox.js",o),m(o)}),[o]),Object(K.jsxs)(Ze.a,{square:!0,className:s.root,children:[Object(K.jsx)(st,{value:u,index:0,children:t[0]}),Object(K.jsx)(st,{value:u,index:1,children:t[1]}),Object(K.jsx)(st,{value:u,index:2,children:t[2]}),Object(K.jsx)(Qe.a,{position:"fixed",color:"primary",className:s.appBar,children:Object(K.jsxs)(et.a,{value:u,onChange:function(e,t){m(t),n(t)},variant:"fullWidth",indicatorColor:"secondary",textColor:"secondary","aria-label":"icon label tabs example",children:[Object(K.jsx)(tt.a,Object(d.a)({icon:Object(K.jsx)(Xe.a,{}),label:"\uce5c\uad6c"},it(0))),Object(K.jsx)(tt.a,Object(d.a)({icon:Object(K.jsx)(ke.a,{color:"secondary",badgeContent:c,children:Object(K.jsx)(ot.a,{})}),label:"\ubc29\ub9ac\uc2a4\ud2b8"},it(1))),Object(K.jsx)(tt.a,Object(d.a)({icon:Object(K.jsx)(at.a,{}),label:"\ucc44\ud305"},it(2)))]})})]})})),ut=Object(i.b)((function(e){return{all_users:e.chats.all_users,myroomlist:e.chats.myroomlist,allroomlist:e.chats.allroomlist,me:e.chats.me[0],focusroom:e.chats.focusroom,allmsglist:e.chats.allmsglist,focusmsg:e.chats.focusmsg,loading1:e.chats.loading1,loading2:e.chats.loading2,loading3:e.chats.loading3,msglength:e.chats.msglength,msglength2:e.chats.msglength2}}),(function(e){return{rx_all_users:function(t){e({type:f,result:t})},rx_me:function(t){e({type:g,result:t})},rx_myroomlist:function(t){e({type:h,result:t})},rx_allroomlist:function(t){e({type:p,result:t})},rx_focusroom:function(t){e(I(t))},rx_allmsglist:function(t){e({type:x,result:t})},rx_connected:function(t){e({type:b,result:t})},login_maintain:function(t){e(z(t))},rx_focusmsg:function(t){e(L(t))},rx_loading1:function(t){e({type:_,result:t})},rx_loading2:function(t){e({type:w,result:t})},rx_loading3:function(t){e({type:C,result:t})},rx_msglength:function(t){e({type:k,result:t})},rx_msglength2:function(t){e(U(t))},rx_tabindex:function(t){e(E(t))},rx_all_my_msglength:function(t){e({type:N,result:t})}}}))((function(e){var t=e.rx_all_users,n=e.all_users,o=e.rx_me,c=e.me,s=e.rx_myroomlist,i=e.myroomlist,l=e.rx_allroomlist,u=e.allroomlist,m=e.rx_focusroom,d=e.focusroom,j=e.rx_allmsglist,f=e.rx_connected,g=e.allmsglist,b=e.rx_focusmsg,h=e.focusmsg,p=e.rx_loading1,x=e.rx_loading2,O=e.rx_loading3,v=e.loading1,y=e.loading2,_=e.loading3,w=e.rx_msglength,C=e.rx_msglength2,k=e.msglength,S=e.msglength2,N=e.rx_tabindex,R=e.rx_all_my_msglength;return Object(a.useEffect)((function(){console.log("[\ud45c\uc2dc]Chat.js"),function(e){X.ref("UsersConnection").on("value",(function(t){console.log("sfajklas",Object.values(t.val())),e(Object.values(t.val()))}))}(f),p(!0),x(!0),O(!0),function(e,t,n){X.ref("all_users").on("value",(function(a){var r=Object.values(a.val());e(r),console.log("response",r);var o=r.filter((function(e){return e.uid.includes(W.currentUser.uid)}));t(o),z(o[0]),console.log("me",o),n(!1)}))}(t,o,p),function(e,t,n){X.ref("room").on("value",(function(a){if(null!==a.val()){var r=Object.values(a.val());console.log("roomListBox",r),e(r);var o=r.filter((function(e){return e.uid.some((function(e){return e===W.currentUser.uid}))}));t(o),console.log("found",o)}else console.log("else"),e([]),t([]);n(!1)}))}(l,s,x),function(e,t){X.ref("msg").on("value",(function(n){if(null!==n.val()){var a=n.val();e(a)}t(!1)}))}(j,O)}),[]),Object(a.useEffect)((function(){g[d]?b(Object.values(g[d])):b([])}),[g,d]),Object(a.useEffect)((function(){u.length>0&&(!function(e,t,n){console.log("CM_msgLength");var a={};t.map((function(t,n){return a[t.msg_key]=e[t.msg_key]?Object.values(e[t.msg_key]).length:0})),X.ref("msgLength/").set(a,(function(e){e?console.log("The write failed..."):(console.log("Data saved successfully!"),n(a))}))}(g,u,w),console.log("\ucd08\uae30 \uba54\uc2dc\uc9c0 \uac2f\uc218 \uc138\ud305"))}),[u,g]),Object(a.useEffect)((function(){u.length>0&&function(e,t,n){console.log("CM_my_msgLength \uc2e4\ud589"),X.ref("My_msgLength2").once("value").then((function(a){var r=a.val();if(r){var o=JSON.parse(JSON.stringify(r));n.map((function(t){return e.map((function(e){return r[t.uid]?(console.log("\uc788\uc5b4"),!r[t.uid][e.msg_key]&&(o[t.uid][e.msg_key]=0)):(console.log("\uc5c6\uc5b4"),o[t.uid]=Object(M.a)({},e.msg_key,0)),o}))})),X.ref("My_msgLength2/").set(o)}else n.map((function(t){return e.map((function(e){return X.ref("My_msgLength2/".concat(t.uid)).update(Object(M.a)({},e.msg_key,0))}))}));X.ref("My_msgLength2").once("value").then((function(e){var n=e.val();t(n)}))}))}(u,C,n)}),[u]),Object(a.useEffect)((function(){null!==k&&null!==S&&function(e,t,n,a){if(console.log("#----CM_my_msgLength_change2"),n){var r=n.map((function(t){return e[t.msg_key]})),o=n.map((function(e){return t[W.currentUser.uid][e.msg_key]?t[W.currentUser.uid][e.msg_key]:0}));a((r=r.reduce((function(e,t){return e+t}),0))-(o=o.reduce((function(e,t){return e+t}),0)))}}(k,S,i,R)}),[k,S]),Object(K.jsxs)(r.a.Fragment,{children:[Object(K.jsx)(se.a,{}),Object(K.jsx)(lt,{content:[Object(K.jsx)(Ae,{title:"\uc804\uccb4 \uce5c\uad6c \ub9ac\uc2a4\ud2b8",data:n,loading:v,event:function(e){!function(e,t,n,a,r){var o=[e.uid,t],c=[e.uid,t].sort();console.log("handleFriend",o[0],o[1]),console.log(n);var s=JSON.parse(JSON.stringify(n));if(s=s.some((function(e){return JSON.stringify(e.uid.sort())===JSON.stringify(c)})),r(2),!s){var i=X.ref("room").push().key;a(i);var l={uid:[e.uid,t],name:[],avatar:e.avatar,msg_key:i},u={};return u["/room/"+i]=l,X.ref().update(u)}var m=JSON.parse(JSON.stringify(n));m=m.filter((function(e){return JSON.stringify(e.uid.sort())===JSON.stringify(c)}))[0].msg_key,console.log("\uc774\ubbf8 \ubc29\uc774 \uc788\uc2b5\ub2c8\ub2e4. \ud604\uc7ac\ub8f8",m),a(m)}(c,e,u,m,N)}}),Object(K.jsx)(Ae,{title:"\ub098\uc758 \ubc29 \ub9ac\uc2a4\ud2b8",data:i,loading:y,event:function(e){console.log("handleRoom"),m(e),q(e,C,S,N)}}),Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(He,{focusmsg:h,loading:_}),Object(K.jsx)(Ke,{})]})]})]})}));var mt=Object(i.b)((function(e){return{authenticated:e.chats.authenticated,me:e.chats.me[0]}}),(function(e){return{rx_authenticated:function(t){e({type:j,result:t})}}}))((function(e){var t=e.rx_authenticated,n=e.authenticated,r=e.me;return Object(a.useEffect)((function(){console.log("[\ud45c\uc2dc]App.js"),function(e){W.onAuthStateChanged((function(t){t?(console.log("App/\ub85c\uadf8\uc778",t),F(!0),e(!0)):(console.log("App/\ub85c\uadf8\uc544\uc6c3",t),F(!1),e(!1))}))}(t)}),[]),Object(K.jsxs)(u.a,{children:[Object(K.jsxs)(m.d,{children:[Object(K.jsx)(Q,{path:"/chat",authenticated:n,component:ut}),Object(K.jsx)(Z,{path:"/signup",authenticated:n,component:Oe}),Object(K.jsx)(Z,{path:["/","/login"],authenticated:n,component:_e})]}),n&&Object(K.jsxs)(V.a,{variant:"contained",style:{display:"none",width:"200px",height:"50px",margin:"50px auto 0 auto"},onClick:function(){Y()},children:["\ub85c\uadf8\uc544\uc6c3(",r&&r.name,")"]})]})})),dt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,210)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)}))},jt=Object(s.combineReducers)({chats:A}),ft=n(106),gt=Object(ft.createLogger)(),bt=Object(s.createStore)(jt,Object(l.composeWithDevTools)(Object(s.applyMiddleware)(gt)));c.a.render(Object(K.jsx)(i.a,{store:bt,children:Object(K.jsx)(mt,{})}),document.getElementById("root")),dt()}},[[140,1,2]]]);
//# sourceMappingURL=main.7a42859e.chunk.js.map